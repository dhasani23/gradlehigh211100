/*
 * Root Build Script for gradlehigh211100
 * 
 * This build script configures the main application that serves as the orchestration
 * module and entry point for all microservices within the system.
 */

buildscript {
    repositories {
        mavenCentral()
        jcenter()
    }
    dependencies {
        // Note: Using a compatible Spring Boot Gradle plugin version with Gradle 4.10.2
        classpath 'org.springframework.boot:spring-boot-gradle-plugin:1.5.22.RELEASE'
    }
}

allprojects {
    group = 'com.gradlehigh211100'
    version = '0.1.0-SNAPSHOT'
    
    repositories {
        mavenCentral()
        jcenter()
    }
}

// Configuration for all Java projects
subprojects {
    apply plugin: 'java'
    apply plugin: 'eclipse'
    apply plugin: 'idea'
    
    sourceCompatibility = 1.8
    targetCompatibility = 1.8
    
    // Common dependencies for all modules
    dependencies {
        testImplementation 'junit:junit:4.12'
    }
}

// Root project configuration
apply plugin: 'java'
apply plugin: 'org.springframework.boot'

dependencies {
    // Module dependencies
    compile project(':common')
    compile project(':user-service')
    compile project(':product-catalog')
    compile project(':order-processing')
    
    // Spring Boot Dependencies
    compile 'org.springframework.boot:spring-boot-starter:1.5.22.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter-web:1.5.22.RELEASE'
    compile 'org.springframework.boot:spring-boot-starter-actuator:1.5.22.RELEASE'
    
    // Spring Cloud Dependencies
    compile 'org.springframework.cloud:spring-cloud-starter-config:1.4.7.RELEASE'
    compile 'org.springframework.cloud:spring-cloud-starter-eureka:1.4.7.RELEASE'
    
    // Micronaut Dependencies
    compile 'io.micronaut:micronaut-core:1.3.7'
    compile 'io.micronaut:micronaut-http-server-netty:1.3.7'
    compile 'io.micronaut:micronaut-runtime:1.3.7'
    
    // Monitoring and Metrics
    compile 'io.micrometer:micrometer-registry-prometheus:1.1.6'
    
    // API Documentation
    compile 'io.springfox:springfox-swagger2:2.9.2'
    compile 'io.springfox:springfox-swagger-ui:2.9.2'
    
    // Database
    runtime 'com.h2database:h2:1.4.197'
    runtime 'org.postgresql:postgresql:42.2.5'
    
    // Test Dependencies
    testCompile 'org.springframework.boot:spring-boot-starter-test'
}

// Task to generate wrapper with specified Gradle version
task wrapper(type: Wrapper) {
    gradleVersion = '4.10.2'
}

// Main class configuration
bootRepackage {
    mainClass = 'com.gradlehigh211100.Application'
    executable = true
}